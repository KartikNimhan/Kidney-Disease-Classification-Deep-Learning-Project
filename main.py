import sys
import os
from cnnClassifier import logger
from cnnClassifier.pipeline.stage_01_data_ingestion import DataIngestionTrainingPipeline
from cnnClassifier.pipeline.stage_02_prepare_base_model import PrepareBaseModelTrainingPipeline
from cnnClassifier.pipeline.stage_03_model_training import ModelTrainingPipeline
from cnnClassifier.pipeline.stage_04_model_evaluation import EvaluationPipeline

logger.info("CONFIG_FILE_PATH: D:\End to end machine learning projects\Kidney Disease classification predication\Kidney-Disease-Classification-Deep-Learning-Project\config\config.yaml")
logger.info("PARAMS_FILE_PATH: D:\End to end machine learning projects\Kidney Disease classification predication\Kidney-Disease-Classification-Deep-Learning-Project\params.yaml")

try:
    logger.info(">>>>> stage Data Ingestion stage started <<<<<<")
    # Create an instance of DataIngestionTrainingPipeline
    data_ingestion_pipeline = DataIngestionTrainingPipeline()
    # Call the main method on the instance
    data_ingestion_pipeline.main()
except Exception as e:
    logger.error(e)
    raise e






STAGE_NAME = "Prepare base model"
try: 
   logger.info(f"*******************")
   logger.info(f">>>>>> stage {STAGE_NAME} started <<<<<<")
   prepare_base_model = PrepareBaseModelTrainingPipeline()
   prepare_base_model.main()
   logger.info(f">>>>>> stage {STAGE_NAME} completed <<<<<<\n\nx==========x")
except Exception as e:
        logger.exception(e)
        raise e



STAGE_NAME = "Training"
try: 
   logger.info(f"*******************")
   logger.info(f">>>>>> stage {STAGE_NAME} started <<<<<<")
   model_trainer = ModelTrainingPipeline()
   model_trainer.main()
   logger.info(f">>>>>> stage {STAGE_NAME} completed <<<<<<\n\nx==========x")
except Exception as e:
        logger.exception(e)
        raise e




STAGE_NAME = "Evaluation stage"
try:
   logger.info(f"*******************")
   logger.info(f">>>>>> stage {STAGE_NAME} started <<<<<<")
   model_evalution = EvaluationPipeline()
   model_evalution.main()
   logger.info(f">>>>>> stage {STAGE_NAME} completed <<<<<<\n\nx==========x")

except Exception as e:
        logger.exception(e)
        raise e